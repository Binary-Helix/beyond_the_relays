############################
#
# Skyllian Blitz 
# Written by Risker & Arrenius
# Coded by Puck and Max
#
############################

namespace = btr_skyblitz_1

##### Skyllian Blitz Act 1 #####

country_event = {
	id = btr_skyblitz_1.1
	title = "btr_skyblitz_1.1.name"
	desc = "btr_skyblitz_1.1.desc"
	picture = GFX_evt_skrand_ship
	show_sound = event_bad_omen

	location = event_target:omega_station
	is_triggered_only = yes

	trigger = {
		AND = {
			mid_game_years_passed >= 10
			end_game_years_passed < 0
		}
		has_origin = caleston_dir_origin
		NOT = {
			has_global_flag = caleston_coup_attempted
		}
	}

	immediate = {
		hidden_effect = {
			create_country = {
				name = "NAME_Elanos_Haliat"
				type = paragon_event_country
				auto_delete = yes
				flag = {
					icon = {
						category = "special"
						file = "unknown.dds"
					}
					background = {
						category = "backgrounds"
						file = "00_solid.dds"
					}
					colors = {
						"red"
						"red"
						"null"
						"null"
					}
				}
				effect = {
					save_global_event_target_as = haliat_insurrectionists
				}
			}
			event_target:haliat_insurrectionists = {
				set_country_flag = haliat_country
				set_faction_hostility = {
					target = root.owner
					set_hostile = no
					set_neutral = yes
					set_friendly = no
				}
				create_leader = {
					class = admiral
					species = event_target:turianSpecies
					name = "NAME_Elanos_Haliat"
					skill = 9
					gender = male
					event_leader = yes
					skip_background_generation = yes
					background_ethic = ethic_fanatic_militarist
					custom_catch_phrase = haliat_catch_phrase
					custom_description = haliat_desc
					randomize_traits = no
					effect = {
						set_leader_flag = legendary_leader
					}
				}
				last_created_leader = {
					set_leader_flag = haliat
					set_leader_flag = immune_to_negative_traits
					save_global_event_target_as = admiral_haliat
					set_owner = event_target:haliat_insurrectionists
					add_trait = leader_trait_carrier_specialization 
					add_trait = leader_trait_engineer_2 
					add_trait = subclass_admiral_tactician
					add_trait = leader_trait_resilient_2
					add_trait = leader_trait_survivalist
					add_trait = leader_trait_unyielding
				}
				create_fleet = {
					name = "NAME_Haliat_Fleet"
					effect = {
						set_owner = event_target:haliat_insurrectionists
						create_ship = {
							name = "NAME_FirstTalon"
							design = "NAME_FirstClaw"
							graphical_culture = tur_01
							upgradable = no
						}
						last_created_ship = {
							set_ship_flag = haliat_shipname
							save_global_event_target_as = haliat_ship
						}
						set_location = {
							target = event_target:omega_station
							distance = 30
							angle = random
						}
						set_fleet_stance = passive
						assign_leader = event_target:admiral_haliat
						save_global_event_target_as = haliat_fleet
					}
					settings = {
						can_upgrade = no
						can_change_composition = no
						can_change_leader = no
						spawn_debris = no
					}
				}
			}
		}
	}

	option = {
		name = "btr_skyblitz_1.1.a"
		hidden_effect = {
			country_event = {
				id = btr_skyblitz_1.4 
				days = 30
				random = 5
			}
		}
	}
	option = {
		name = "btr_skyblitz_1.1.b"
		hidden_effect = {
			country_event = {
				id = btr_skyblitz_1.2
				days = 7
			}
		}
	}
}

country_event = {
	id = btr_skyblitz_1.2
	title = "btr_skyblitz_1.2.name"
	desc = "btr_skyblitz_1.2.desc"
	picture = GFX_evt_skrand_ship
	show_sound = event_air_raid_siren
	is_triggered_only = yes
	auto_opens = yes
	fire_only_once = yes

	trigger = {
		NOT = {
			has_global_flag = haliat_coup_initiated
		}
	}

	immediate = {
		log = "btr_skyblitz_1.2 fired"
		if = {
			limit = { 
				has_country_flag = haliat_country
			 }
			 set_country_type = faction
			 establish_communications_no_message = root.owner
			 establish_contact = { who = root.owner location = root.solar_system }
		}
		if = {
			limit = {
				any_galaxy_planet = { has_planet_flag = caleston_planet }
			}
			random_galaxy_planet = {
				limit = { has_planet_flag = caleston_planet }
				planet_event = { id = btr_skyblitz_1.3 days = 5 }
				set_global_flag = haliat_coup_initiated
			}
		}
	}

	option = {
		name = btr_skyblitz_1.2.a
		custom_tooltip = haliat_coup
	}
}

planet_event = {
	id = btr_skyblitz_1.3
	title = "btr_skyblitz_1.3.name"
	desc = "btr_skyblitz_1.3.desc"
	picture = GFX_evt_alien_nature
	show_sound = event_air_raid_siren
	is_triggered_only = yes
	location = ROOT

	auto_opens = yes

	pre_triggers = {
		has_owner = yes
		original_owner = yes
		has_ground_combat = no
	}

	trigger = {
		has_planet_flag = caleston_planet
	}

	immediate = {
		if = {
			limit = { 
				has_planet_flag = caleston_planet
			}
			log = "btr_skyblitz_1.3 Firing"
			set_planet_flag = haliat_coup_planet
			owner = {
				set_country_flag = caleston_coup_empire
			}
			create_army = {
				name = "NAME_Eclipse_Merc_Company"
				owner = event_target:haliat_insurrectionists
				species	= "event_target:asariSpecies"
				type = assault_army
			}
			create_army = {
				name = "NAME_Eclipse_Merc_Company"
				owner = event_target:haliat_insurrectionists
				species	= "event_target:asariSpecies"
				type = assault_army
			}
			create_army = {
				name = "NAME_Eclipse_Merc_Company"
				owner = event_target:haliat_insurrectionists
				species	= "event_target:salarianSpecies"
				type = assault_army
			}
			create_army = {
				name = "NAME_Eclipse_Merc_Company"
				owner = event_target:haliat_insurrectionists
				species	= "event_target:salarianSpecies"
				type = assault_army
			}
		}
	}

	option = {
		name = btr_skyblitz_1.3.a
		custom_tooltip = haliat_armies
	}
}




# country_event = {
# 	id = btr_skyblitz_1.2

# 	is_triggered_only = yes

# 	trigger = {
		
# 	}
# }


# country_event = {
# 	id = btr_skyblitz_1.3

# 	is_triggered_only = yes

# 	trigger = {
		
# 	}
# }

# country_event = {
# 	id = btr_skyblitz_1.4

# 	is_triggered_only = yes

# 	trigger = {
		
# 	}
# }

# country_event = {
# 	id = btr_skyblitz_1.5

# 	is_triggered_only = yes

# 	trigger = {
		
# 	}
# }

# country_event = {
# 	id = btr_skyblitz_1.6

# 	is_triggered_only = yes

# 	trigger = {
		
# 	}
# }

# country_event = {
# 	id = btr_skyblitz_1.7

# 	is_triggered_only = yes

# 	trigger = {
		
# 	}
# }

# country_event = {
# 	id = btr_skyblitz_1.8

# 	is_triggered_only = yes

# 	trigger = {
		
# 	}
# }

# country_event = {
# 	id = btr_skyblitz_1.9

# 	is_triggered_only = yes

# 	trigger = {
		
# 	}
# }

# country_event = {
# 	id = btr_skyblitz_1.10

# 	is_triggered_only = yes

# 	trigger = {
		
# 	}
# }

# country_event = {
# 	id = btr_skyblitz_1.11

# 	is_triggered_only = yes

# 	trigger = {
		
# 	}
# }
